<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Yoode Price Estimator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.4.21/vue.global.prod.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

    <link
        href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&family=Poppins:wght@600;700;800&display=swap"
        rel="stylesheet" />
    <style>
        :root {
            --bg: #f5f6fb;
            --surface: #ffffff;
            --surface2: #f0f1f9;
            --surface3: #e8eaf5;
            --border: #dde0f0;
            --border2: #c8cce8;
            --text: #12141f;
            --text2: #3a3d55;
            --muted: #7b7fa0;
            --yblue: #2937cc;
            --yblue-lt: #eceffe;
            --yblue-mid: rgba(41, 55, 204, 0.12);
            --yorange: #f65e21;
            --yor-lt: #fff1ec;
            --yor-mid: rgba(246, 94, 33, 0.12);
            --shadow-sm: 0 1px 4px rgba(41, 55, 204, 0.06), 0 2px 16px rgba(41, 55, 204, 0.04);
            --shadow-md: 0 4px 24px rgba(41, 55, 204, 0.10), 0 1px 4px rgba(41, 55, 204, 0.06);
            --shadow-lg: 0 8px 40px rgba(41, 55, 204, 0.13);
            --ring: rgba(41, 55, 204, 0.18);
            --ring-or: rgba(246, 94, 33, 0.20);
            --radius: 16px;
            --tog-bg: #e4e7f8;
        }

        body.dark {
            --bg: #0d0e14;
            --surface: #13151f;
            --surface2: #1a1c2a;
            --surface3: #22253a;
            --border: #272b3f;
            --border2: #323660;
            --text: #edeef8;
            --text2: #a8aacc;
            --muted: #5d6082;
            --yblue: #4c5ef5;
            --yblue-lt: rgba(76, 94, 245, 0.12);
            --yblue-mid: rgba(76, 94, 245, 0.18);
            --yorange: #ff7340;
            --yor-lt: rgba(255, 115, 64, 0.10);
            --yor-mid: rgba(255, 115, 64, 0.16);
            --shadow-sm: 0 1px 4px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 24px rgba(0, 0, 0, 0.35);
            --shadow-lg: 0 8px 40px rgba(0, 0, 0, 0.45);
            --ring: rgba(76, 94, 245, 0.22);
            --ring-or: rgba(255, 115, 64, 0.22);
            --tog-bg: #1e2038;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'DM Sans', sans-serif;
            font-size: 15px;
            min-height: 100vh;
            transition: background .4s ease, color .4s ease;
        }

        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--border2);
            border-radius: 3px;
        }

        @keyframes fadeUp {
            from {
                opacity: 0;
                transform: translateY(18px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulseDot {

            0%,
            100% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.7);
                opacity: .5;
            }
        }

        @keyframes slideRight {
            from {
                transform: scaleX(0);
            }

            to {
                transform: scaleX(1);
            }
        }

        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(.88);
            }

            70% {
                transform: scale(1.04);
            }

            100% {
                opacity: 1;
                transform: scale(1);
            }
        }

        /* ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ */
        .header {
            background: var(--surface);
            border-bottom: 1px solid var(--border);
            padding: 0 48px;
            height: 64px;
            display: flex;
            align-items: center;
            gap: 20px;
            position: sticky;
            top: 0;
            z-index: 200;
            box-shadow: var(--shadow-sm);
            transition: background .4s, border-color .4s, box-shadow .4s;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--yblue) 0%, var(--yorange) 100%);
        }

        .logo-wrap {
            display: flex;
            flex-direction: column;
            gap: 1px;
        }

        .header-logo {
            font-family: 'Poppins', sans-serif;
            font-size: 22px;
            font-weight: 800;
            letter-spacing: -.5px;
            line-height: 1;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .logo-img {
            height: 24px;
            width: auto;
            display: block;
            object-fit: contain;
            transition: filter .4s;
        }

        body.dark .logo-img {
            filter: brightness(0) invert(1);
        }

        .logo-dot-anim {
            display: inline-block;
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: var(--yorange);
            margin-left: 3px;
            vertical-align: middle;
            animation: pulseDot 2.2s ease-in-out infinite;
        }

        .header-sub {
            font-size: 12px;
            font-weight: 600;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--muted);
        }

        /* ‚îÄ‚îÄ‚îÄ THEME TOGGLE ‚îÄ‚îÄ‚îÄ */
        .theme-toggle {
            display: flex;
            align-items: center;
            gap: 9px;
            background: var(--surface2);
            border: 1.5px solid var(--border);
            border-radius: 50px;
            padding: 6px 14px 6px 7px;
            cursor: pointer;
            user-select: none;
            transition: border-color .25s, box-shadow .25s, background .4s, transform .15s;
        }

        .theme-toggle:hover {
            border-color: var(--yblue);
            box-shadow: 0 0 0 3px var(--ring);
        }

        .theme-toggle:active {
            transform: scale(.96);
        }

        .tog-track {
            width: 36px;
            height: 20px;
            border-radius: 10px;
            background: var(--tog-bg);
            position: relative;
            flex-shrink: 0;
            transition: background .4s;
        }

        body.dark .tog-track {
            background: #2a2e50;
        }

        .tog-thumb {
            position: absolute;
            width: 14px;
            height: 14px;
            border-radius: 50%;
            top: 3px;
            left: 3px;
            transition: transform .35s cubic-bezier(.34, 1.56, .64, 1), background .3s, box-shadow .3s;
        }

        body:not(.dark) .tog-thumb {
            transform: translateX(16px);
            background: var(--yorange);
            box-shadow: 0 0 8px var(--ring-or);
        }

        body.dark .tog-thumb {
            transform: translateX(0);
            background: #9ba4f5;
            box-shadow: 0 0 8px rgba(155, 164, 245, .5);
        }

        .tog-icon {
            font-size: 14px;
            line-height: 1;
        }

        .tog-label {
            font-size: 14px;
            font-weight: 600;
            color: var(--muted);
            white-space: nowrap;
            transition: color .4s;
        }

        /* ‚îÄ‚îÄ‚îÄ STEP TRAIL ‚îÄ‚îÄ‚îÄ */
        .step-trail {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .step-node {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: 700;
            border: 2px solid var(--border);
            color: var(--muted);
            background: var(--surface);
            transition: all .3s;
        }

        .step-node.active {
            border-color: var(--yblue);
            color: var(--yblue);
            box-shadow: 0 0 0 4px var(--ring);
        }

        .step-node.done {
            background: var(--yblue);
            border-color: var(--yblue);
            color: #fff;
            font-size: 0;
            box-shadow: none;
        }

        .step-node.done::after {
            content: '‚úì';
            font-size: 13px;
        }

        .step-line {
            width: 28px;
            height: 2px;
            background: var(--border);
            border-radius: 2px;
            position: relative;
            overflow: hidden;
        }

        .step-line.filled::after {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--yblue);
            border-radius: 2px;
            animation: slideRight .4s ease forwards;
            transform-origin: left;
        }

        /* ‚îÄ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ‚îÄ */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 36px 48px 80px;
        }

        /* ‚îÄ‚îÄ‚îÄ CARDS ‚îÄ‚îÄ‚îÄ */
        .card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 28px 32px;
            margin-bottom: 18px;
            box-shadow: var(--shadow-sm);
            animation: fadeUp .35s ease both;
            transition: box-shadow .3s, border-color .3s, background .4s;
            position: relative;
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
            background: transparent;
            border-radius: 3px 0 0 3px;
            transition: background .3s;
        }

        .card.active::before {
            background: var(--yblue);
        }

        .card:hover {
            box-shadow: var(--shadow-md);
        }

        .card-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 18px;
            font-weight: 700;
            color: var(--text);
            margin-bottom: 22px;
            transition: color .4s;
        }

        .card-title .num {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: var(--yblue);
            color: #fff;
            width: 28px;
            height: 28px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 800;
            flex-shrink: 0;
        }

        /* ‚îÄ‚îÄ‚îÄ SEGMENTED CONTROL ‚îÄ‚îÄ‚îÄ */
        .seg-ctrl {
            display: inline-flex;
            flex-wrap: wrap;
            background: var(--surface2);
            border-radius: 12px;
            padding: 5px;
            gap: 4px;
            border: 1px solid var(--border);
        }

        .seg-btn {
            padding: 10px 30px;
            border-radius: 9px;
            border: none;
            background: transparent;
            color: var(--muted);
            font-family: 'DM Sans', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all .22s;
            white-space: nowrap;
        }

        .seg-btn:hover:not(.active) {
            background: var(--yblue-lt);
            color: var(--yblue);
        }

        .seg-btn.active {
            background: var(--yblue);
            color: #fff;
            box-shadow: 0 3px 12px var(--ring);
        }

        /* ‚îÄ‚îÄ‚îÄ SELECT ‚îÄ‚îÄ‚îÄ */
        .custom-select {
            background: var(--surface2);
            border: 1.5px solid var(--border);
            color: var(--text);
            border-radius: 12px;
            padding: 12px 40px 12px 16px;
            font-family: 'DM Sans', sans-serif;
            font-size: 15px;
            outline: none;
            cursor: pointer;
            width: 100%;
            max-width: 480px;
            transition: border-color .2s, box-shadow .2s, background .4s;
            -webkit-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%237b7fa0' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 16px center;
        }

        .custom-select:focus {
            border-color: var(--yblue);
            box-shadow: 0 0 0 3px var(--ring);
        }

        /* ‚îÄ‚îÄ‚îÄ QUANTITY FIELD ‚îÄ‚îÄ‚îÄ */
        .qty-wrap {
            display: flex;
            align-items: stretch;
            gap: 16px;
            flex-wrap: wrap;
        }

        .qty-field {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .qty-field-label {
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--muted);
        }

        .qty-input-large {
            background: var(--surface2);
            border: 1.5px solid var(--border);
            color: var(--text);
            border-radius: 12px;
            padding: 14px 20px;
            text-align: center;
            font-family: 'DM Sans', sans-serif;
            font-size: 28px;
            font-weight: 800;
            outline: none;
            width: 180px;
            transition: border-color .2s, box-shadow .2s, background .2s;
            -moz-appearance: textfield;
        }

        .qty-input-large::-webkit-outer-spin-button,
        .qty-input-large::-webkit-inner-spin-button {
            -webkit-appearance: none;
        }

        .qty-input-large:focus {
            border-color: var(--yblue);
            box-shadow: 0 0 0 3px var(--ring);
            background: var(--yblue-lt);
        }

        .qty-info-box {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 4px;
            padding: 16px 22px;
            background: var(--yblue-lt);
            border: 1px solid var(--ring);
            border-radius: 12px;
            min-width: 160px;
            transition: background .4s;
        }

        body.dark .qty-info-box {
            background: var(--yblue-mid);
        }

        .qty-info-label {
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            color: var(--yblue);
        }

        .qty-info-val {
            font-family: 'Poppins', sans-serif;
            font-size: 26px;
            font-weight: 800;
            color: var(--yblue);
            line-height: 1;
        }

        .qty-info-sub {
            font-size: 12px;
            color: var(--muted);
            font-weight: 500;
        }

        /* MRP box */
        .mrp-box {
            display: flex;
            flex-direction: column;
            justify-content: center;
            gap: 4px;
            padding: 16px 22px;
            background: var(--yor-lt);
            border: 1px solid var(--ring-or);
            border-radius: 12px;
            min-width: 140px;
            transition: background .4s;
        }

        body.dark .mrp-box {
            background: var(--yor-mid);
        }

        .mrp-label {
            font-size: 11px;
            font-weight: 700;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            color: var(--yorange);
        }

        .mrp-val {
            font-family: 'Poppins', sans-serif;
            font-size: 26px;
            font-weight: 800;
            color: var(--yorange);
            line-height: 1;
        }

        /* ‚îÄ‚îÄ‚îÄ WARNING / NOTICE ‚îÄ‚îÄ‚îÄ */
        .warning {
            margin-top: 14px;
            background: var(--yor-lt);
            border: 1.5px solid var(--ring-or);
            border-radius: 10px;
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 600;
            color: var(--yorange);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .warning::before {
            content: '‚ö†';
            font-size: 16px;
            flex-shrink: 0;
        }

        .moq-notice {
            margin-top: 14px;
            background: var(--yblue-lt);
            border: 1.5px solid var(--ring);
            border-radius: 10px;
            padding: 12px 16px;
            font-size: 14px;
            font-weight: 600;
            color: var(--yblue);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .moq-notice::before {
            content: '‚Ñπ';
            font-size: 16px;
            flex-shrink: 0;
        }

        /* ‚îÄ‚îÄ‚îÄ ADDONS ‚îÄ‚îÄ‚îÄ */
        .addons-section {
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .addon-location {
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: 14px;
            overflow: hidden;
            transition: background .4s, border-color .4s;
            animation: fadeUp .3s ease both;
        }

        .addon-loc-header {
            padding: 12px 20px;
            font-size: 13px;
            font-weight: 800;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--yblue);
            display: flex;
            align-items: center;
            gap: 10px;
            background: var(--yblue-lt);
            border-bottom: 1px solid var(--ring);
            transition: background .4s;
        }

        body.dark .addon-loc-header {
            background: var(--yblue-mid);
        }

        .addon-loc-header::before {
            content: '';
            width: 3px;
            height: 14px;
            background: var(--yblue);
            border-radius: 2px;
            flex-shrink: 0;
        }

        /* Scrollable addon table wrapper */
        .addon-rows-wrap {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        .addon-rows-wrap::-webkit-scrollbar {
            height: 4px;
        }

        .addon-rows-wrap::-webkit-scrollbar-thumb {
            background: var(--border2);
            border-radius: 2px;
        }

        .addon-rows {
            padding: 4px 16px 16px;
            min-width: 900px;
        }

        /* Fixed column widths that won't collapse */
        .addon-row {
            display: grid;
            grid-template-columns: 210px 90px 120px 76px 76px 76px 152px 115px;
            gap: 8px;
            align-items: center;
            padding: 12px 8px;
            border-bottom: 1px solid var(--border);
            transition: background .2s;
            border-radius: 8px;
        }

        .addon-row:last-child {
            border-bottom: none;
        }

        .addon-row:hover {
            background: var(--surface3);
        }

        .addon-type {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 0;
        }

        .addon-type span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .col-label {
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 0.8px;
            text-transform: uppercase;
            color: var(--text2);
            margin-bottom: 4px;
            white-space: nowrap;
        }

        .field-group {
            display: flex;
            flex-direction: column;
            min-width: 0;
        }

        .mobile-label {
            display: none;
        }

        .info-val {
            font-size: 14px;
            font-weight: 600;
            color: var(--text);
            padding: 4px 0;
            white-space: nowrap;
        }

        .info-orange {
            font-size: 15px;
            font-weight: 700;
            color: var(--yorange);
            white-space: nowrap;
        }

        /* ‚îÄ‚îÄ‚îÄ TOGGLE SWITCH ‚îÄ‚îÄ‚îÄ */
        .toggle-wrap {
            display: flex;
            align-items: center;
            cursor: pointer;
            flex-shrink: 0;
        }

        .tog-sw {
            width: 38px;
            height: 21px;
            background: var(--border2);
            border-radius: 10.5px;
            position: relative;
            transition: background .25s, box-shadow .25s;
            flex-shrink: 0;
        }

        .tog-sw.on {
            background: var(--yorange);
            box-shadow: 0 0 0 3px var(--ring-or);
        }

        .tog-sw::after {
            content: '';
            position: absolute;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #fff;
            top: 3px;
            left: 3px;
            transition: transform .28s cubic-bezier(.34, 1.56, .64, 1);
            box-shadow: 0 1px 4px rgba(0, 0, 0, .2);
        }

        .tog-sw.on::after {
            transform: translateX(17px);
        }

        /* ‚îÄ‚îÄ‚îÄ NUM INPUT ‚îÄ‚îÄ‚îÄ */
        .num-input {
            background: var(--surface);
            border: 1.5px solid var(--border);
            color: var(--text);
            border-radius: 9px;
            padding: 7px 6px;
            font-family: 'DM Sans', sans-serif;
            font-size: 14px;
            font-weight: 600;
            outline: none;
            width: 100%;
            -moz-appearance: textfield;
            transition: border-color .2s, box-shadow .2s;
            text-align: center;
        }

        .num-input::-webkit-outer-spin-button,
        .num-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
        }

        .num-input:focus {
            border-color: var(--yblue);
            box-shadow: 0 0 0 3px var(--ring);
        }

        .num-input:disabled {
            opacity: .35;
            cursor: not-allowed;
        }

        /* ‚îÄ‚îÄ‚îÄ COMPLEXITY SELECT ‚îÄ‚îÄ‚îÄ */
        .complexity-select {
            background: var(--surface);
            border: 1.5px solid var(--border);
            color: var(--text);
            border-radius: 9px;
            padding: 7px 20px 7px 8px;
            font-family: 'DM Sans', sans-serif;
            font-size: 13px;
            font-weight: 600;
            outline: none;
            width: 100%;
            cursor: pointer;
            -webkit-appearance: none;
            appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 12 12'%3E%3Cpath fill='%237b7fa0' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 6px center;
            transition: border-color .2s, box-shadow .2s;
        }

        .complexity-select:focus {
            border-color: var(--yblue);
            box-shadow: 0 0 0 3px var(--ring);
        }

        .complexity-select:disabled {
            opacity: .35;
            cursor: not-allowed;
        }

        /* ‚îÄ‚îÄ‚îÄ SUMMARY ‚îÄ‚îÄ‚îÄ */
        .summary-card {
            background: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 30px 32px;
            margin-bottom: 18px;
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
            animation: fadeUp .35s ease both;
        }

        .summary-card::after {
            content: '';
            position: absolute;
            top: -80px;
            right: -80px;
            width: 200px;
            height: 200px;
            border-radius: 50%;
            background: radial-gradient(circle, var(--yblue-mid) 0%, transparent 70%);
            pointer-events: none;
        }

        .kpi-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px;
            margin-bottom: 22px;
        }

        .kpi-box {
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 20px 22px;
            transition: background .4s;
            position: relative;
            overflow: hidden;
        }

        .kpi-box::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
        }

        .kpi-box.blue-kpi::before {
            background: var(--yblue);
        }

        .kpi-box.orange-kpi::before {
            background: var(--yorange);
        }

        .kpi-label {
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--muted);
            margin-bottom: 8px;
        }

        .kpi-val {
            font-family: 'Poppins', sans-serif;
            font-size: 36px;
            font-weight: 800;
            color: var(--text);
            line-height: 1;
        }

        .kpi-val.blue {
            color: var(--yblue);
        }

        .kpi-val.orange {
            color: var(--yorange);
        }

        .kpi-unit {
            font-family: 'DM Sans', sans-serif;
            font-size: 16px;
            color: var(--muted);
            font-weight: 400;
        }

        .shipping-row {
            display: flex;
            align-items: center;
            gap: 16px;
            padding: 15px 18px;
            background: var(--surface2);
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 20px;
            transition: background .4s;
            flex-wrap: wrap;
        }

        .shipping-row label {
            font-size: 14px;
            font-weight: 500;
            color: var(--text2);
            flex: 1;
            min-width: 160px;
        }

        .shipping-input {
            background: var(--surface);
            border: 1.5px solid var(--border);
            color: var(--text);
            border-radius: 10px;
            padding: 9px 14px;
            font-family: 'DM Sans', sans-serif;
            font-size: 15px;
            font-weight: 600;
            outline: none;
            width: 160px;
            -moz-appearance: textfield;
            transition: border-color .2s, box-shadow .2s;
            text-align: right;
        }

        .shipping-input::-webkit-outer-spin-button,
        .shipping-input::-webkit-inner-spin-button {
            -webkit-appearance: none;
        }

        .shipping-input:focus {
            border-color: var(--yblue);
            box-shadow: 0 0 0 3px var(--ring);
        }

        .breakdown-wrap {
            border: 1px solid var(--border);
            border-radius: 12px;
            overflow: auto;
            margin-bottom: 22px;
        }

        .breakdown-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
            min-width: 400px;
        }

        .breakdown-table th {
            text-align: left;
            padding: 10px 16px;
            font-size: 11px;
            font-weight: 800;
            letter-spacing: 2px;
            text-transform: uppercase;
            color: var(--muted);
            background: var(--surface2);
            border-bottom: 1px solid var(--border);
            white-space: nowrap;
        }

        .breakdown-table th:not(:first-child) {
            text-align: right;
        }

        .breakdown-table td {
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
            color: var(--text2);
            font-weight: 500;
            transition: color .4s;
        }

        .breakdown-table td:not(:first-child) {
            text-align: right;
            white-space: nowrap;
        }

        .breakdown-table tr:last-child td {
            border-bottom: none;
        }

        .breakdown-table tr:hover td {
            background: var(--surface3);
        }

        .breakdown-table .grand-row td {
            font-weight: 700;
            font-size: 15px;
            color: var(--yorange);
            background: var(--yor-lt);
            border-top: 2px solid var(--ring-or);
        }

        body.dark .breakdown-table .grand-row td {
            background: var(--yor-mid);
        }

        .final-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 14px;
        }

        .final-hero {
            border-radius: 16px;
            padding: 24px 26px;
            position: relative;
            overflow: hidden;
            animation: popIn .4s cubic-bezier(.34, 1.56, .64, 1) both;
        }

        .final-hero.blue-hero {
            background: var(--yblue);
            box-shadow: 0 6px 28px var(--ring);
        }

        .final-hero.orange-hero {
            background: var(--yorange);
            box-shadow: 0 6px 28px var(--ring-or);
        }

        .final-hero::after {
            content: '';
            position: absolute;
            top: -30px;
            right: -30px;
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: rgba(255, 255, 255, .08);
        }

        .final-hero .f-label {
            font-size: 10px;
            font-weight: 700;
            letter-spacing: 2.5px;
            text-transform: uppercase;
            color: rgba(255, 255, 255, .65);
            margin-bottom: 8px;
        }

        .final-hero .f-val {
            font-family: 'Poppins', sans-serif;
            font-size: 40px;
            font-weight: 800;
            color: #fff;
            line-height: 1;
        }

        /* ‚îÄ‚îÄ‚îÄ EXPORT BUTTONS ‚îÄ‚îÄ‚îÄ */
        .export-row {
            display: flex;
            gap: 12px;
            margin-top: 22px;
            flex-wrap: wrap;
        }

        .export-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 11px 22px;
            border: 1.5px solid var(--border2);
            border-radius: 12px;
            background: var(--surface2);
            color: var(--text);
            font-family: 'DM Sans', sans-serif;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: background .2s, border-color .2s, box-shadow .2s, transform .15s;
        }

        .export-btn:hover {
            background: var(--yblue-lt);
            border-color: var(--yblue);
            box-shadow: 0 0 0 3px var(--ring);
            transform: translateY(-1px);
        }

        .export-btn:active {
            transform: translateY(0);
        }

        .export-btn svg {
            width: 18px;
            height: 18px;
            flex-shrink: 0;
        }

        .export-btn.pdf-btn:hover {
            background: var(--yor-lt);
            border-color: var(--yorange);
            box-shadow: 0 0 0 3px var(--ring-or);
        }

        /* ‚îÄ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ‚îÄ */
        /* Large screens ‚Äî wider layout */
        @media (min-width: 1200px) {
            .container {
                padding: 40px 60px 80px;
            }

            .addon-row {
                grid-template-columns: 230px 100px 130px 82px 82px 82px 162px 125px;
            }
        }

        /* Medium screens */
        @media (max-width: 1024px) {
            .container {
                padding: 28px 28px 70px;
            }

            .header {
                padding: 0 24px;
            }
        }

        /* Tablet */
        @media (max-width: 768px) {
            .header {
                padding: 0 16px;
                height: auto;
                min-height: 64px;
                flex-wrap: wrap;
                padding-top: 8px;
                padding-bottom: 8px;
                gap: 10px;
            }

            .step-trail {
                margin-left: 0;
                order: 3;
                width: 100%;
                justify-content: center;
                padding-bottom: 4px;
            }

            .container {
                padding: 20px 16px 60px;
            }

            .card {
                padding: 20px 18px;
            }

            .summary-card {
                padding: 20px 18px;
            }

            .card-title {
                font-size: 16px;
            }

            .kpi-grid {
                grid-template-columns: 1fr 1fr;
            }

            .kpi-val {
                font-size: 28px;
            }

            .final-grid {
                grid-template-columns: 1fr 1fr;
            }

            .final-hero .f-val {
                font-size: 30px;
            }

            .qty-wrap {
                gap: 12px;
            }

            .qty-input-large {
                width: 140px;
                font-size: 24px;
            }

            .seg-btn {
                padding: 9px 18px;
                font-size: 13px;
            }

            .tog-label {
                display: none;
            }

            /* Addon rows ‚Üí card layout */
            .addon-rows {
                min-width: 0;
                padding: 8px 8px 12px;
            }

            .addon-row-header  .col-label{
                /* display: none; */
                visibility: hidden;
                height: 0;
            }
            

            .addon-row {
                display: grid;
                grid-template-columns: 1fr 1fr;
                gap: 0;
                padding: 0;
                border: 1px solid var(--border);
                border-radius: 10px;
                margin-bottom: 12px;
                overflow: hidden;
            }

            .addon-row:last-child {
                margin-bottom: 0;
            }

            .addon-type {
                grid-column: 1 / -1;
                padding: 10px 12px;
                background: var(--surface3);
                border-bottom: 1px solid var(--border);
                font-size: 15px;
            }

            .addon-row > .field-group {
                padding: 8px 12px;
                border-bottom: 1px solid var(--border);
                border-right: 1px solid var(--border);
            }

            .addon-row > .field-group:nth-child(odd) {
                border-right: 1px solid var(--border);
            }

            .addon-row > .field-group:nth-child(even) {
                border-right: none;
            }

            .mobile-label {
                display: block;
                font-size: 11px;
                font-weight: 700;
                letter-spacing: 0.6px;
                text-transform: uppercase;
                color: var(--text2);
                margin-bottom: 4px;
            }

            .addon-placeholder {
                display: none;
            }

            .addon-total-cell {
                grid-column: 1 / -1;
                background: var(--surface3);
                border-bottom: none;
                border-right: none;
                padding: 10px 12px;
                display: flex;
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
            }

            .addon-total-cell .mobile-label {
                margin-bottom: 0;
                font-size: 12px;
            }

            body.dark .addon-total-cell {
                background: var(--surface2);
            }

            /* Breakdown table ‚Üí fluid */
            .breakdown-table {
                min-width: 0;
            }

            .breakdown-table td:first-child,
            .breakdown-table th:first-child {
                word-break: break-word;
                white-space: normal;
            }
        }

        /* Mobile */
        @media (max-width: 480px) {
            .header {
                padding: 8px 12px;
                gap: 8px;
            }

            .header-logo {
                font-size: 18px;
            }

            .header-sub {
                font-size: 10px;
                letter-spacing: 1px;
            }

            .container {
                padding: 14px 12px 50px;
            }

            .card {
                padding: 16px 14px;
            }

            .summary-card {
                padding: 16px 14px;
            }

            .kpi-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .final-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .kpi-val {
                font-size: 32px;
            }

            .final-hero .f-val {
                font-size: 34px;
            }

            .qty-wrap {
                flex-direction: column;
                align-items: stretch;
            }

            .qty-input-large {
                width: 100%;
            }

            .qty-info-box,
            .mrp-box {
                min-width: unset;
                width: 100%;
            }

            .custom-select {
                max-width: 100%;
            }

            .seg-ctrl {
                width: 100%;
            }

            .seg-btn {
                flex: 1;
                padding: 10px 10px;
                font-size: 13px;
                text-align: center;
            }

            .shipping-input {
                width: 130px;
            }

            /* Tighter addon cards on small phones */
            .addon-rows {
                padding: 6px 4px 10px;
            }

            .addon-type {
                padding: 8px 10px;
                font-size: 14px;
            }

            .addon-row > .field-group {
                padding: 6px 10px;
            }

            .addon-total-cell {
                padding: 8px 10px;
            }

            /* Tighter breakdown table */
            .breakdown-table th,
            .breakdown-table td {
                padding: 8px 10px;
                font-size: 13px;
            }
        }

        .card:nth-child(1) {
            animation-delay: .05s;
        }

        .card:nth-child(2) {
            animation-delay: .10s;
        }

        .card:nth-child(3) {
            animation-delay: .15s;
        }

        .card:nth-child(4) {
            animation-delay: .20s;
        }

        .addon-location:nth-child(1) {
            animation-delay: .05s;
        }

        .addon-location:nth-child(2) {
            animation-delay: .10s;
        }

        .addon-location:nth-child(3) {
            animation-delay: .15s;
        }

        .addon-location:nth-child(4) {
            animation-delay: .20s;
        }
        
    </style>
</head>

<body>
    <div id="app">

        <!-- HEADER -->
        <div class="header">
            <div class="logo-wrap">
                <div class="header-logo">
                    <img src="logo-clr.png" alt="Yoode" class="logo-img" /><span class="logo-dot-anim"></span>
                </div>
                <div class="header-sub">Price Estimator</div>
            </div>

            <div class="theme-toggle" @click="toggleTheme" :title="isDark ? 'Switch to Light' : 'Switch to Dark'">
                <div class="tog-track">
                    <div class="tog-thumb"></div>
                </div>
                <span class="tog-icon">{{isDark ? 'üåô' : '‚òÄÔ∏è'}}</span>
                <span class="tog-label">{{isDark ? 'Dark' : 'Light'}}</span>
            </div>

            <div class="step-trail">
                <div class="step-node" :class="{active: step===1, done: step>1}">{{step>1?'':1}}</div>
                <div class="step-line" :class="{filled: step>1}"></div>
                <div class="step-node" :class="{active: step===2, done: step>2}">{{step>2?'':2}}</div>
                <div class="step-line" :class="{filled: step>2}"></div>
                <div class="step-node" :class="{active: step===3, done: step>3}">{{step>3?'':3}}</div>
                <div class="step-line" :class="{filled: step>3}"></div>
                <div class="step-node" :class="{active: step===4}">4</div>
            </div>
        </div>

        <div class="container">

            <!-- STEP 1 ‚Äî Customer Type -->
            <div class="card" :class="{active: step===1}">
                <div class="card-title"><span class="num">1</span>Customer Type</div>
                <div class="seg-ctrl">
                    <button v-for="ct in customerTypes" :key="ct" class="seg-btn" :class="{active: customerType===ct}"
                        @click="setCustomerType(ct)">{{ct}}</button>
                </div>
            </div>

            <!-- STEP 2 ‚Äî Product Style -->
            <div class="card" :class="{active: step===2}">
                <div class="card-title"><span class="num">2</span>Product Style</div>
                <select class="custom-select" v-model="selectedProduct" @change="onProductChange">
                    <option value="">‚Äî Select a Product ‚Äî</option>
                    <option v-for="p in products" :key="p" :value="p">{{p}}</option>
                </select>
            </div>

            <!-- STEP 3 ‚Äî Quantity -->
            <div class="card" :class="{active: step===3}" v-if="selectedProduct">
                <div class="card-title"><span class="num">3</span>Quantity</div>
                <div class="qty-wrap">
                    <div class="qty-field">
                        <div class="qty-field-label">Number of Pieces</div>
                        <input type="number" class="qty-input-large" min="1" v-model.number="quantity"
                            placeholder="0" />
                    </div>
                    <div class="qty-info-box" v-if="pricePerItem > 0">
                        <div class="qty-info-label">Price / Piece</div>
                        <div class="qty-info-val">‚Çπ{{fmt(pricePerItem)}}</div>
                        <div class="qty-info-sub">Volume price for {{quantity}} pcs</div>
                    </div>
                    <div class="mrp-box" v-if="mrpPerItem > 0">
                        <div class="mrp-label">MRP</div>
                        <div class="mrp-val">‚Çπ{{fmt(mrpPerItem)}}</div>
                    </div>
                </div>
                <div class="warning" v-if="pricePerItem === 0 && quantity > 0">
                    No pricing tier found for this product &amp; quantity.
                </div>
                <div class="moq-notice" v-if="screenPrintMOQWarning">
                    Screen Print requires a minimum order of 50 pieces.
                </div>
            </div>

            <!-- STEP 4 ‚Äî Add-ons -->
            <div class="card" :class="{active: step===4}"
                v-if="quantity > 0 && selectedProduct && addonLocations.length > 0">
                <div class="card-title"><span class="num">4</span>Decoration &amp; Add-ons</div>
                <div class="addons-section">
                    <div class="addon-location" v-for="loc in addonLocations" :key="loc.name">
                        <div class="addon-loc-header">{{loc.name}}</div>
                        <div class="addon-rows-wrap">
                            <div class="addon-rows">

                                <!-- Header row labels -->
                                <div class="addon-row addon-row-header"
                                    style="padding:4px 6px 2px; border-bottom: 1px solid var(--border);">
                                    <div class="col-label">Add-on</div>
                                    <div class="col-label">Setup</div>
                                    <div class="col-label">Rate</div>
                                    <div class="col-label">Colours</div>
                                    <div class="col-label">W (inch)</div>
                                    <div class="col-label">H (inch)</div>
                                    <div class="col-label">Complexity</div>
                                    <div class="col-label">Total / item</div>
                                </div>

                                <div v-for="addon in loc.addons" :key="addon.type" class="addon-row">

                                    <!-- Toggle + Name -->
                                    <div class="addon-type">
                                        <div class="toggle-wrap" @click="toggleAddon(loc.name, addon.type)">
                                            <div class="tog-sw" :class="{on: isAddonEnabled(loc.name, addon.type)}">
                                            </div>
                                        </div>
                                        <span>{{addon.type}}</span>
                                    </div>

                                    <!-- Setup Charge -->
                                    <div class="field-group">
                                        <span class="mobile-label">Setup</span>
                                        <div class="info-val">{{getSetupCharge(addon.type) > 0 ? '‚Çπ' +
                                            getSetupCharge(addon.type) : '‚Äî'}}</div>
                                    </div>

                                    <!-- Rate -->
                                    <div class="field-group">
                                        <span class="mobile-label">Rate</span>
                                        <div class="info-val">
                                            ‚Çπ{{getRate(addon.type)}}
                                            <span style="font-size:12px;color:var(--muted);font-weight:500;">
                                                {{addon.type.startsWith('Embroidery') ? '/1k st' : '/inch'}}
                                            </span>
                                        </div>
                                    </div>

                                    <!-- Colours (Screen Print only) -->
                                    <div class="field-group" v-if="addon.type === 'Screen Print'">
                                        <span class="mobile-label">Colours</span>
                                        <input type="number" class="num-input" min="1"
                                            :disabled="!isAddonEnabled(loc.name, addon.type)"
                                            v-model.number="getAddonState(loc.name, addon.type).colours" />
                                    </div>
                                    <div v-else class="field-group addon-placeholder">
                                        <span class="mobile-label">Colours</span>
                                        <div class="info-val" style="color:var(--muted)">‚Äî</div>
                                    </div>

                                    <!-- Width -->
                                    <div class="field-group">
                                        <span class="mobile-label">W (inch)</span>
                                        <input type="number" class="num-input" min="0.1" step="0.1"
                                            :disabled="!isAddonEnabled(loc.name, addon.type)"
                                            v-model.number="getAddonState(loc.name, addon.type).width" />
                                    </div>

                                    <!-- Height -->
                                    <div class="field-group">
                                        <span class="mobile-label">H (inch)</span>
                                        <input type="number" class="num-input" min="0.1" step="0.1"
                                            :disabled="!isAddonEnabled(loc.name, addon.type)"
                                            v-model.number="getAddonState(loc.name, addon.type).height" />
                                    </div>

                                    <!-- Complexity (Embroidery only) -->
                                    <div class="field-group" v-if="addon.type.startsWith('Embroidery')">
                                        <span class="mobile-label">Complexity</span>
                                        <select class="complexity-select"
                                            :disabled="!isAddonEnabled(loc.name, addon.type)"
                                            v-model="getAddonState(loc.name, addon.type).complexity">
                                            <option v-for="c in complexityOptions" :key="c" :value="c">{{c}}</option>
                                        </select>
                                    </div>
                                    <div v-else class="field-group addon-placeholder">
                                        <span class="mobile-label">Complexity</span>
                                        <div class="info-val" style="color:var(--muted)">‚Äî</div>
                                    </div>

                                    <!-- Total / item -->
                                    <div class="field-group addon-total-cell">
                                        <span class="mobile-label">Total / item</span>
                                        <div class="info-orange">
                                            {{getAddonTotal(loc.name, addon.type) > 0
                                            ? '‚Çπ' + fmt(getAddonTotal(loc.name, addon.type))
                                            : '‚Äî'}}
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- No addons notice -->
            <div class="card" v-if="quantity > 0 && selectedProduct && addonLocations.length === 0"
                style="background: var(--surface2);">
                <div style="color: var(--muted); font-size: 14px; font-weight: 500;">
                    ‚Ñπ No decoration add-ons available for this product.
                </div>
            </div>

            <!-- PRICE SUMMARY -->
            <div class="summary-card" v-if="quantity > 0 && pricePerItem > 0">
                <div class="card-title" style="margin-bottom:22px;">
                    <span class="num" style="background:var(--yorange)">5</span>Price Summary
                </div>

                <div class="kpi-grid">
                    <div class="kpi-box blue-kpi">
                        <div class="kpi-label">Base Price / Item</div>
                        <div class="kpi-val blue">‚Çπ{{fmt(pricePerItem)}}</div>
                    </div>
                    <div class="kpi-box orange-kpi">
                        <div class="kpi-label">Total Quantity</div>
                        <div class="kpi-val orange">{{quantity}}<span class="kpi-unit"> pcs</span></div>
                    </div>
                </div>

                <div class="shipping-row">
                    <label>Shipping &amp; Other Charges (‚Çπ)</label>
                    <input type="number" class="shipping-input" v-model.number="shippingCharges" min="0"
                        placeholder="0" />
                </div>

                <div class="breakdown-wrap">
                    <table class="breakdown-table">
                        <thead>
                            <tr>
                                <th>Component</th>
                                <th>Per Item (‚Çπ)</th>
                                <th>Total (‚Çπ)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Base Product Price</td>
                                <td>{{fmt(pricePerItem)}}</td>
                                <td>{{fmt(pricePerItem * quantity)}}</td>
                            </tr>
                            <tr v-for="row in addonBreakdown" :key="row.label">
                                <td>{{row.label}}</td>
                                <td>{{fmt(row.perItem)}}</td>
                                <td>{{fmt(row.total)}}</td>
                            </tr>
                            <tr v-if="totalSetupCharges > 0">
                                <td>Setup Charges</td>
                                <td>‚Äî</td>
                                <td>{{fmt(totalSetupCharges)}}</td>
                            </tr>
                            <tr v-if="shippingCharges > 0">
                                <td>Shipping &amp; Other</td>
                                <td>‚Äî</td>
                                <td>{{fmt(shippingCharges)}}</td>
                            </tr>
                            <tr class="grand-row">
                                <td>Grand Total</td>
                                <td>{{fmt(finalPricePerItem)}}</td>
                                <td>{{fmt(grandTotal)}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="final-grid">
                    <div class="final-hero blue-hero">
                        <div class="f-label">Final Price Per Item</div>
                        <div class="f-val">‚Çπ{{fmt(finalPricePerItem)}}</div>
                    </div>
                    <div class="final-hero orange-hero">
                        <div class="f-label">Grand Total</div>
                        <div class="f-val">‚Çπ{{fmt(grandTotal)}}</div>
                    </div>
                </div>

                <div class="export-row">
                    <button class="export-btn pdf-btn" @click="exportPDF">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="12" y1="18" x2="12" y2="12"/><polyline points="9 15 12 18 15 15"/></svg>
                        Export PDF
                    </button>
                    <button class="export-btn word-btn" @click="exportWord">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
                        Export Word
                    </button>
                </div>
            </div>

        </div>
    </div>

    <script>
        const { createApp, reactive, ref, computed } = Vue;

        // ‚îÄ‚îÄ PRODUCT DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // From Product_Data sheet ‚Äî [product, min, max, mrp, retail, corporate, reseller]
        // MRP is null for Cozy range
        const PRODUCT_DATA = [
            ['Men Plain Crew Neck', 1, 9, 649, 449, 349, 249],
            ['Men Plain Crew Neck', 10, 49, 649, 429, 329, 249],
            ['Men Plain Crew Neck', 50, 99, 649, 399, 299, 249],
            ['Men Plain Crew Neck', 100, null, 649, 369, 269, 249],
            ['Men Amid Crew Neck', 1, 9, 699, 499, 399, 299],
            ['Men Amid Crew Neck', 10, 49, 699, 479, 379, 299],
            ['Men Amid Crew Neck', 50, 99, 699, 449, 349, 299],
            ['Men Amid Crew Neck', 100, null, 699, 419, 319, 299],
            ['Men SoftTouch Crew Neck', 1, 9, 799, 599, 499, 399],
            ['Men SoftTouch Crew Neck', 10, 49, 799, 579, 479, 399],
            ['Men SoftTouch Crew Neck', 50, 99, 799, 549, 449, 399],
            ['Men SoftTouch Crew Neck', 100, null, 799, 519, 419, 399],
            ['Men SoftTouch Oversized', 1, 9, 899, 699, 599, 499],
            ['Men SoftTouch Oversized', 10, 49, 899, 679, 579, 499],
            ['Men SoftTouch Oversized', 50, 99, 899, 649, 549, 499],
            ['Men SoftTouch Oversized', 100, null, 899, 619, 519, 499],
            ['Men Brisk Polo', 1, 9, 749, 549, 449, 349],
            ['Men Brisk Polo', 10, 49, 749, 529, 429, 349],
            ['Men Brisk Polo', 50, 99, 749, 499, 399, 349],
            ['Men Brisk Polo', 100, null, 749, 469, 369, 349],
            ['Men Plain Polo', 1, 9, 799, 599, 499, 399],
            ['Men Plain Polo', 10, 49, 799, 579, 479, 399],
            ['Men Plain Polo', 50, 99, 799, 549, 449, 399],
            ['Men Plain Polo', 100, null, 799, 519, 419, 399],
            ['Men Performance Polo', 1, 9, 849, 649, 549, 449],
            ['Men Performance Polo', 10, 49, 849, 629, 529, 449],
            ['Men Performance Polo', 50, 99, 849, 599, 499, 449],
            ['Men Performance Polo', 100, null, 849, 569, 469, 449],
            ['Men Flexi Polo', 1, 9, 899, 699, 599, 499],
            ['Men Flexi Polo', 10, 49, 899, 679, 579, 499],
            ['Men Flexi Polo', 50, 99, 899, 649, 549, 499],
            ['Men Flexi Polo', 100, null, 899, 619, 519, 499],
            ['Men SoftTouch Polo', 1, 9, 949, 749, 649, 549],
            ['Men SoftTouch Polo', 10, 49, 949, 729, 629, 549],
            ['Men SoftTouch Polo', 50, 99, 949, 699, 599, 549],
            ['Men SoftTouch Polo', 100, null, 949, 669, 569, 549],
            ['Men Printed Collar SoftTouch Polo', 1, 9, 999, 799, 699, 599],
            ['Men Printed Collar SoftTouch Polo', 10, 49, 999, 779, 679, 599],
            ['Men Printed Collar SoftTouch Polo', 50, 99, 999, 749, 649, 599],
            ['Men Printed Collar SoftTouch Polo', 100, null, 999, 719, 619, 599],
            ['Men Cozy Hoodie', 1, 9, null, 499, 424.15, 349.3],
            ['Men Cozy Hoodie', 10, 49, null, 449, 381.65, 314.3],
            ['Men Cozy Hoodie', 50, 99, null, 399, 339.15, 279.3],
            ['Men Cozy Hoodie', 100, null, null, 349, 296.65, 244.3],
            ['Men Cozy Zipper Hoodie', 1, 9, null, 499, 424.15, 349.3],
            ['Men Cozy Zipper Hoodie', 10, 49, null, 449, 381.65, 314.3],
            ['Men Cozy Zipper Hoodie', 50, 99, null, 399, 339.15, 279.3],
            ['Men Cozy Zipper Hoodie', 100, null, null, 349, 296.65, 244.3],
            ['Men Cozy Sweatshirt', 1, 9, null, 499, 424.15, 349.3],
            ['Men Cozy Sweatshirt', 10, 49, null, 449, 381.65, 314.3],
            ['Men Cozy Sweatshirt', 50, 99, null, 399, 339.15, 279.3],
            ['Men Cozy Sweatshirt', 100, null, null, 349, 296.65, 244.3],
            ['Men Cozy Varsity Jacket', 1, 9, null, 499, 424.15, 349.3],
            ['Men Cozy Varsity Jacket', 10, 49, null, 449, 381.65, 314.3],
            ['Men Cozy Varsity Jacket', 50, 99, null, 399, 339.15, 279.3],
            ['Men Cozy Varsity Jacket', 100, null, null, 349, 296.65, 244.3],
            ['Men Cozy Joggers', 1, 9, null, 499, 424.15, 349.3],
            ['Men Cozy Joggers', 10, 49, null, 449, 381.65, 314.3],
            ['Men Cozy Joggers', 50, 99, null, 399, 339.15, 279.3],
            ['Men Cozy Joggers', 100, null, null, 349, 296.65, 244.3],
            ['Men Cozy Shorts', 1, 9, null, 499, 424.15, 349.3],
            ['Men Cozy Shorts', 10, 49, null, 449, 381.65, 314.3],
            ['Men Cozy Shorts', 50, 99, null, 399, 339.15, 279.3],
            ['Men Cozy Shorts', 100, null, null, 349, 296.65, 244.3],
            ['Women Plain Crew Neck', 1, 9, 649, 449, 349, 249],
            ['Women Plain Crew Neck', 10, 49, 649, 429, 329, 249],
            ['Women Plain Crew Neck', 50, 99, 649, 399, 299, 249],
            ['Women Plain Crew Neck', 100, null, 649, 369, 269, 249],
            ['Women Amid Crop Top', 1, 9, 599, 499, 399, 299],
            ['Women Amid Crop Top', 10, 49, 599, 479, 379, 299],
            ['Women Amid Crop Top', 50, 99, 599, 449, 349, 299],
            ['Women Amid Crop Top', 100, null, 599, 419, 319, 299],
            ['Women Amid Crew Neck', 1, 9, 899, 699, 560, 532],
            ['Women Amid Crew Neck', 10, 49, 699, 629, 504, 476],
            ['Women Amid Crew Neck', 50, 99, 699, 615, 493, 465],
            ['Women Amid Crew Neck', 100, null, 699, 594, 476, 448],
            ['Women SoftTouch Crew Neck', 1, 9, 899, 699, 560, 532],
            ['Women SoftTouch Crew Neck', 10, 49, 699, 629, 504, 476],
            ['Women SoftTouch Crew Neck', 50, 99, 699, 615, 493, 465],
            ['Women SoftTouch Crew Neck', 100, null, 699, 594, 476, 448],
            ['Women SoftTouch Oversized', 1, 9, 899, 699, 599, 499],
            ['Women SoftTouch Oversized', 10, 49, 899, 679, 579, 499],
            ['Women SoftTouch Oversized', 50, 99, 899, 649, 549, 499],
            ['Women SoftTouch Oversized', 100, null, 899, 619, 519, 499],
        ];

        // ‚îÄ‚îÄ RATES ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // From Data sheet ‚Äî [style, addon, min, max, retail, corporate, reseller]
        const RATES = [
            ['Setup Charge', 'Screen Print', 1, 9, 1200, 1100, 1000],
            ['Setup Charge', 'Screen Print', 10, 49, 500, 500, 500],
            ['Setup Charge', 'Screen Print', 50, 99, 500, 500, 500],
            ['Setup Charge', 'Screen Print', 100, null, 500, 500, 500],
            ['Setup Charge', 'Embroidery (Standard)', 1, 9, 200, 200, 200],
            ['Setup Charge', 'Embroidery (Standard)', 10, 49, 100, 100, 100],
            ['Setup Charge', 'Embroidery (Standard)', 50, 99, 0, 0, 0],
            ['Setup Charge', 'Embroidery (Standard)', 100, null, 0, 0, 0],
            ['Setup Charge', 'Embroidery (Coloreel)', 1, 9, 400, 350, 300],
            ['Setup Charge', 'Embroidery (Coloreel)', 10, 49, 400, 350, 300],
            ['Setup Charge', 'Embroidery (Coloreel)', 50, 99, 400, 350, 300],
            ['Setup Charge', 'Embroidery (Coloreel)', 100, null, 400, 350, 300],
            ['Rate', 'DTG', 1, 9, 1.2, 1.1, 1],
            ['Rate', 'DTG', 10, 49, 1.2, 1.1, 1],
            ['Rate', 'DTG', 50, 99, 1.2, 1.1, 1],
            ['Rate', 'DTG', 100, null, 1.2, 1.1, 1],
            ['Rate', 'DTF', 1, 9, 0.5, 0.5, 0.5],
            ['Rate', 'DTF', 10, 49, 0.5, 0.5, 0.5],
            ['Rate', 'DTF', 50, 99, 0.5, 0.5, 0.5],
            ['Rate', 'DTF', 100, null, 0.5, 0.5, 0.5],
            ['Rate', 'Screen Print', 1, 9, 4, 4, 4],
            ['Rate', 'Screen Print', 10, 49, 4, 4, 4],
            ['Rate', 'Screen Print', 50, 99, 4, 4, 4],
            ['Rate', 'Screen Print', 100, null, 4, 4, 4],
            ['Rate', 'Embroidery (Standard)', 1, 9, 8, 8, 8],
            ['Rate', 'Embroidery (Standard)', 10, 49, 6, 6, 6],
            ['Rate', 'Embroidery (Standard)', 50, 99, 5, 5, 5],
            ['Rate', 'Embroidery (Standard)', 100, null, 4, 4, 4],
            ['Rate', 'Embroidery (Coloreel)', 1, 9, 10, 10, 10],
            ['Rate', 'Embroidery (Coloreel)', 10, 49, 8, 8, 8],
            ['Rate', 'Embroidery (Coloreel)', 50, 99, 6, 6, 6],
            ['Rate', 'Embroidery (Coloreel)', 100, null, 6, 6, 6],
        ];

        // MOQ per addon type (from Data sheet MOQ rows)
        const MOQ = {
            'DTG': 1,
            'DTF': 1,
            'Screen Print': 50,
            'Embroidery (Standard)': 1,
            'Embroidery (Coloreel)': 1,
        };

        // ‚îÄ‚îÄ COMPLEXITY COVERAGE FACTORS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // From Data!J:K
        const COMPLEXITY = {
            'Light (text/outline)': 0.7,
            'Medium (logo)': 0.85,
            'Full Fill': 1.0,
            'Patch/Badge Heavy': 1.2,
        };

        // ‚îÄ‚îÄ PRODUCT ‚Üí ADDONS MAPPING ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
        // From Product_Addon sheet ‚Äî Textile Patch excluded
        const PRODUCT_ADDONS = {
            'Men Plain Crew Neck': [],
            'Men Amid Crew Neck': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men SoftTouch Crew Neck': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men SoftTouch Oversized': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Brisk Polo': ['DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Plain Polo': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Performance Polo': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Flexi Polo': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men SoftTouch Polo': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Printed Collar SoftTouch Polo': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Cozy Hoodie': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Cozy Zipper Hoodie': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Cozy Sweatshirt': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Cozy Varsity Jacket': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Cozy Joggers': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Men Cozy Shorts': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Women Plain Crew Neck': [],
            'Women Amid Crop Top': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Women Amid Crew Neck': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Women SoftTouch Crew Neck': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
            'Women SoftTouch Oversized': ['DTG', 'DTF', 'Screen Print', 'Embroidery (Standard)', 'Embroidery (Coloreel)'],
        };

        const LOCATIONS = ['FRONT', 'BACK', 'LEFT SLEEVE', 'RIGHT SLEEVE'];

        createApp({
            setup() {
                const isDark = ref(false);
                function toggleTheme() {
                    isDark.value = !isDark.value;
                    document.body.classList.toggle('dark', isDark.value);
                }

                const customerTypes = ['Retail', 'Corporate', 'Reseller'];
                const customerType = ref('Retail');

                const products = Object.keys(PRODUCT_ADDONS);
                const selectedProduct = ref('');
                const quantity = ref(0);
                const shippingCharges = ref(0);
                const addonStates = reactive({});
                const complexityOptions = Object.keys(COMPLEXITY);

                const step = computed(() => {
                    if (!selectedProduct.value) return 1;
                    if (!quantity.value || quantity.value <= 0) return 3;
                    return 4;
                });

                function ctIdx() {
                    return customerType.value === 'Retail' ? 0
                        : customerType.value === 'Corporate' ? 1 : 2;
                }

                function lookupRate(style, addon, qty) {
                    const ci = ctIdx();
                    for (const r of RATES.filter(r => r[0] === style && r[1] === addon)) {
                        const [, , min, max, ret, corp, res] = r;
                        if (qty >= min && (max === null || qty <= max))
                            return [ret, corp, res][ci];
                    }
                    return 0;
                }

                // Base price per item
                const pricePerItem = computed(() => {
                    if (!selectedProduct.value || !quantity.value || quantity.value <= 0) return 0;
                    const ci = ctIdx();
                    for (const r of PRODUCT_DATA.filter(r => r[0] === selectedProduct.value)) {
                        const [, min, max, mrp, ret, corp, res] = r;
                        if (quantity.value >= min && (max === null || quantity.value <= max))
                            return [ret, corp, res][ci];
                    }
                    return 0;
                });

                // MRP per item
                const mrpPerItem = computed(() => {
                    if (!selectedProduct.value || !quantity.value || quantity.value <= 0) return 0;
                    for (const r of PRODUCT_DATA.filter(r => r[0] === selectedProduct.value)) {
                        const [, min, max, mrp] = r;
                        if (quantity.value >= min && (max === null || quantity.value <= max))
                            return mrp || 0;
                    }
                    return 0;
                });

                // Show MOQ warning if qty < 50 and Screen Print would be relevant
                const screenPrintMOQWarning = computed(() => {
                    const addons = PRODUCT_ADDONS[selectedProduct.value] || [];
                    return addons.includes('Screen Print') && quantity.value > 0 && quantity.value < 50;
                });

                // Addon locations
                const addonLocations = computed(() => {
                    if (!selectedProduct.value) return [];
                    const addons = PRODUCT_ADDONS[selectedProduct.value] || [];
                    if (!addons.length) return [];
                    return LOCATIONS.map(loc => ({ name: loc, addons: addons.map(type => ({ type })) }));
                });

                function addonKey(loc, type) { return `${loc}||${type}`; }

                function getAddonState(loc, type) {
                    const k = addonKey(loc, type);
                    if (!addonStates[k]) {
                        addonStates[k] = reactive({
                            enabled: false,
                            width: 4,
                            height: 4,
                            colours: 1,
                            complexity: 'Light (text/outline)',
                        });
                    }
                    return addonStates[k];
                }

                function isAddonEnabled(loc, type) { return getAddonState(loc, type).enabled; }

                function toggleAddon(loc, type) {
                    // Screen Print: enforce MOQ of 50
                    if (type === 'Screen Print' && quantity.value < MOQ['Screen Print']) return;
                    const s = getAddonState(loc, type);
                    s.enabled = !s.enabled;
                }

                function getSetupCharge(type) { return lookupRate('Setup Charge', type, quantity.value); }
                function getRate(type) { return lookupRate('Rate', type, quantity.value); }

                function getAddonTotal(loc, type) {
                    const s = getAddonState(loc, type);
                    if (!s.enabled) return 0;
                    const rate = getRate(type);
                    const w = s.width || 4;
                    const h = s.height || 4;
                    const area = w * h; // inch

                    if (type === 'DTG') {
                        return Math.max(80, area * rate);
                    }
                    if (type === 'DTF') {
                        return Math.max(40, area * rate);
                    }
                    if (type === 'Screen Print') {
                        // Rate is per inch per colour
                        const cols = s.colours || 1;
                        return Math.max(20, area * rate * cols);
                    }
                    if (type === 'Embroidery (Standard)') {
                        const cf = COMPLEXITY[s.complexity] || 0.7;
                        const stitches = area * 1000 * cf;
                        return Math.max(30, (stitches / 1000) * rate);
                    }
                    if (type === 'Embroidery (Coloreel)') {
                        const cf = COMPLEXITY[s.complexity] || 0.7;
                        const stitches = area * 1000 * cf;
                        return Math.max(40, (stitches / 1000) * rate);
                    }
                    return 0;
                }

                const addonBreakdown = computed(() => {
                    if (!selectedProduct.value) return [];
                    const rows = [];
                    for (const loc of LOCATIONS) {
                        for (const type of (PRODUCT_ADDONS[selectedProduct.value] || [])) {
                            const t = getAddonTotal(loc, type);
                            if (t > 0) rows.push({
                                label: `${loc} ‚Äî ${type}`,
                                perItem: t,
                                total: t * quantity.value,
                            });
                        }
                    }
                    return rows;
                });

                const totalAddonPerItem = computed(() =>
                    addonBreakdown.value.reduce((s, r) => s + r.perItem, 0)
                );

                const totalSetupCharges = computed(() => {
                    let total = 0;
                    for (const loc of LOCATIONS) {
                        for (const type of (PRODUCT_ADDONS[selectedProduct.value] || [])) {
                            const s = getAddonState(loc, type);
                            if (s.enabled) {
                                const sc = getSetupCharge(type);
                                // Screen Print: setup √ó colours; others: flat per location
                                total += type === 'Screen Print' ? sc * (s.colours || 1) : sc;
                            }
                        }
                    }
                    return total;
                });

                const grandTotal = computed(() =>
                    pricePerItem.value * quantity.value
                    + totalAddonPerItem.value * quantity.value
                    + totalSetupCharges.value
                    + (shippingCharges.value || 0)
                );

                const finalPricePerItem = computed(() =>
                    quantity.value <= 0 ? 0 : grandTotal.value / quantity.value
                );

                function setCustomerType(ct) { customerType.value = ct; }

                function onProductChange() {
                    quantity.value = 0;
                    Object.keys(addonStates).forEach(k => delete addonStates[k]);
                }

                function fmt(val) {
                    if (!val || val === 0) return '0';
                    const n = Number(val);
                    return n % 1 === 0 ? n.toLocaleString('en-IN') : n.toFixed(2);
                }

                // ‚îÄ‚îÄ EXPORT HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
                function getEnabledAddonDetails() {
                    var details = [];
                    for (var li = 0; li < LOCATIONS.length; li++) {
                        var loc = LOCATIONS[li];
                        var addons = PRODUCT_ADDONS[selectedProduct.value] || [];
                        for (var ai = 0; ai < addons.length; ai++) {
                            var type = addons[ai];
                            var s = getAddonState(loc, type);
                            if (s.enabled) {
                                var detail = { location: loc, type: type, width: s.width, height: s.height, rate: getRate(type), setup: getSetupCharge(type), total: getAddonTotal(loc, type) };
                                if (type === 'Screen Print') detail.colours = s.colours;
                                if (type.indexOf('Embroidery') === 0) detail.complexity = s.complexity;
                                details.push(detail);
                            }
                        }
                    }
                    return details;
                }

                function buildEstimationHTML() {
                    var today = new Date().toLocaleDateString('en-IN', { day: '2-digit', month: 'short', year: 'numeric' });
                    var rs = '\u20B9';
                    var dash = '\u2014';
                    var c = '<\/td>';
                    var r = '<\/tr>';
                    var th = '<\/th>';

                    // Addon detail rows for breakdown table
                    var addonRows = '';
                    for (var i = 0; i < addonBreakdown.value.length; i++) {
                        var row = addonBreakdown.value[i];
                        addonRows += '<tr><td style="padding:10px 12px;border-bottom:1px solid #eee;">' + row.label + c + '<td style="padding:10px 12px;border-bottom:1px solid #eee;text-align:right;">' + rs + fmt(row.perItem) + c + '<td style="padding:10px 12px;border-bottom:1px solid #eee;text-align:right;">' + rs + fmt(row.total) + c + r;
                    }
                    if (totalSetupCharges.value > 0) {
                        addonRows += '<tr><td style="padding:10px 12px;border-bottom:1px solid #eee;">Setup Charges' + c + '<td style="padding:10px 12px;border-bottom:1px solid #eee;text-align:right;">' + dash + c + '<td style="padding:10px 12px;border-bottom:1px solid #eee;text-align:right;">' + rs + fmt(totalSetupCharges.value) + c + r;
                    }
                    if (shippingCharges.value > 0) {
                        addonRows += '<tr><td style="padding:10px 12px;border-bottom:1px solid #eee;">Shipping &amp; Other' + c + '<td style="padding:10px 12px;border-bottom:1px solid #eee;text-align:right;">' + dash + c + '<td style="padding:10px 12px;border-bottom:1px solid #eee;text-align:right;">' + rs + fmt(shippingCharges.value) + c + r;
                    }

                    // Addon specification rows
                    var addonDetails = getEnabledAddonDetails();
                    var addonSpecHTML = '';
                    if (addonDetails.length > 0) {
                        addonSpecHTML = '<div style="margin-bottom:24px;">'
                            + '<h3 style="margin:0 0 12px;font-size:14px;color:#2937cc;letter-spacing:1.5px;text-transform:uppercase;">Add-on Specifications<\/h3>'
                            + '<table style="width:100%;border-collapse:collapse;font-size:13px;">'
                            + '<thead><tr style="background:#f0f1f9;">'
                            + '<th style="padding:8px 10px;text-align:left;font-size:10px;letter-spacing:1px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">Location' + th
                            + '<th style="padding:8px 10px;text-align:left;font-size:10px;letter-spacing:1px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">Add-on Type' + th
                            + '<th style="padding:8px 10px;text-align:center;font-size:10px;letter-spacing:1px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">W (inch)' + th
                            + '<th style="padding:8px 10px;text-align:center;font-size:10px;letter-spacing:1px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">H (inch)' + th
                            + '<th style="padding:8px 10px;text-align:center;font-size:10px;letter-spacing:1px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">Details' + th
                            + '<th style="padding:8px 10px;text-align:right;font-size:10px;letter-spacing:1px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">Setup' + th
                            + '<th style="padding:8px 10px;text-align:right;font-size:10px;letter-spacing:1px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">Cost/Item' + th
                            + r + '<\/thead><tbody>';

                        for (var d = 0; d < addonDetails.length; d++) {
                            var a = addonDetails[d];
                            var extra = '';
                            if (a.colours) extra = a.colours + ' colour' + (a.colours > 1 ? 's' : '');
                            if (a.complexity) extra = a.complexity;
                            addonSpecHTML += '<tr>'
                                + '<td style="padding:8px 10px;border-bottom:1px solid #eee;">' + a.location + c
                                + '<td style="padding:8px 10px;border-bottom:1px solid #eee;">' + a.type + c
                                + '<td style="padding:8px 10px;border-bottom:1px solid #eee;text-align:center;">' + a.width + c
                                + '<td style="padding:8px 10px;border-bottom:1px solid #eee;text-align:center;">' + a.height + c
                                + '<td style="padding:8px 10px;border-bottom:1px solid #eee;text-align:center;">' + extra + c
                                + '<td style="padding:8px 10px;border-bottom:1px solid #eee;text-align:right;">' + rs + fmt(a.setup) + c
                                + '<td style="padding:8px 10px;border-bottom:1px solid #eee;text-align:right;">' + rs + fmt(a.total) + c
                                + r;
                        }
                        addonSpecHTML += '<\/tbody><\/table><\/div>';
                    }

                    return '<div style="font-family:Segoe UI,Arial,sans-serif;color:#1a1a2e;max-width:700px;margin:0 auto;padding:30px;">'
                        // Header
                        + '<div style="text-align:center;margin-bottom:28px;">'
                        + '<h1 style="margin:0;font-size:28px;color:#2937cc;letter-spacing:1px;">YOODE<\/h1>'
                        + '<p style="margin:4px 0 0;font-size:11px;letter-spacing:3px;color:#7b7fa0;text-transform:uppercase;">Price Estimation<\/p>'
                        + '<p style="margin:8px 0 0;font-size:12px;color:#999;">Date: ' + today + '<\/p>'
                        + '<\/div>'
                        // Order info
                        + '<table style="width:100%;border-collapse:collapse;margin-bottom:24px;border:1px solid #dde0f0;border-radius:8px;">'
                        + '<tr style="background:#f0f1f9;">'
                        + '<td style="padding:10px 14px;font-size:12px;color:#7b7fa0;font-weight:700;width:25%;">Customer Type' + c
                        + '<td style="padding:10px 14px;font-size:14px;font-weight:700;width:25%;">' + customerType.value + c
                        + '<td style="padding:10px 14px;font-size:12px;color:#7b7fa0;font-weight:700;width:25%;">Product' + c
                        + '<td style="padding:10px 14px;font-size:14px;font-weight:700;width:25%;">' + selectedProduct.value + c
                        + r
                        + '<tr>'
                        + '<td style="padding:10px 14px;font-size:12px;color:#7b7fa0;font-weight:700;">Quantity' + c
                        + '<td style="padding:10px 14px;font-size:14px;font-weight:700;">' + quantity.value + ' pcs' + c
                        + '<td style="padding:10px 14px;font-size:12px;color:#7b7fa0;font-weight:700;">Base Price / Item' + c
                        + '<td style="padding:10px 14px;font-size:14px;font-weight:700;">' + rs + fmt(pricePerItem.value) + c
                        + r
                        + '<\/table>'
                        // Addon specifications
                        + addonSpecHTML
                        // Cost breakdown
                        + '<h3 style="margin:0 0 12px;font-size:14px;color:#2937cc;letter-spacing:1.5px;text-transform:uppercase;">Cost Breakdown<\/h3>'
                        + '<table style="width:100%;border-collapse:collapse;margin-bottom:24px;font-size:13px;">'
                        + '<thead><tr style="background:#f0f1f9;">'
                        + '<th style="padding:10px 12px;text-align:left;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">Component' + th
                        + '<th style="padding:10px 12px;text-align:right;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">Per Item (' + rs + ')' + th
                        + '<th style="padding:10px 12px;text-align:right;font-size:10px;letter-spacing:1.5px;text-transform:uppercase;color:#7b7fa0;border-bottom:2px solid #dde0f0;">Total (' + rs + ')' + th
                        + r + '<\/thead><tbody>'
                        + '<tr><td style="padding:10px 12px;border-bottom:1px solid #eee;">Base Product Price' + c + '<td style="padding:10px 12px;border-bottom:1px solid #eee;text-align:right;">' + rs + fmt(pricePerItem.value) + c + '<td style="padding:10px 12px;border-bottom:1px solid #eee;text-align:right;">' + rs + fmt(pricePerItem.value * quantity.value) + c + r
                        + addonRows
                        + '<tr style="background:#fff1ec;font-weight:700;font-size:14px;color:#f65e21;">'
                        + '<td style="padding:12px;border-top:2px solid #f65e21;">Grand Total' + c
                        + '<td style="padding:12px;border-top:2px solid #f65e21;text-align:right;">' + rs + fmt(finalPricePerItem.value) + c
                        + '<td style="padding:12px;border-top:2px solid #f65e21;text-align:right;">' + rs + fmt(grandTotal.value) + c
                        + r + '<\/tbody><\/table>'
                        // Final summary boxes
                        + '<table style="width:100%;border-collapse:collapse;">'
                        + '<tr>'
                        + '<td style="width:50%;padding:16px;background:#2937cc;color:#fff;text-align:center;">'
                        + '<div style="font-size:10px;letter-spacing:2px;text-transform:uppercase;opacity:.7;margin-bottom:6px;">Final Price Per Item<\/div>'
                        + '<div style="font-size:28px;font-weight:800;">' + rs + fmt(finalPricePerItem.value) + '<\/div>'
                        + c
                        + '<td style="width:50%;padding:16px;background:#f65e21;color:#fff;text-align:center;">'
                        + '<div style="font-size:10px;letter-spacing:2px;text-transform:uppercase;opacity:.7;margin-bottom:6px;">Grand Total<\/div>'
                        + '<div style="font-size:28px;font-weight:800;">' + rs + fmt(grandTotal.value) + '<\/div>'
                        + c
                        + r + '<\/table>'
                        + '<p style="text-align:center;margin-top:30px;font-size:11px;color:#aaa;">Generated by Yoode Price Estimator<\/p>'
                        + '<\/div>';
                }

                function exportPDF() {
                    var html = buildEstimationHTML();

                    var printFrame = document.createElement('iframe');
                    printFrame.style.position = 'fixed';
                    printFrame.style.right = '0';
                    printFrame.style.bottom = '0';
                    printFrame.style.width = '0';
                    printFrame.style.height = '0';
                    printFrame.style.border = 'none';
                    document.body.appendChild(printFrame);

                    var doc = printFrame.contentDocument || printFrame.contentWindow.document;
                    doc.open();
                    doc.write('<!DOCTYPE html><html><head><meta charset="utf-8">'
                        + '<title>Yoode Price Estimation<\/title>'
                        + '<style>'
                        + '@page { size: A4; margin: 10mm; }'
                        + 'body { margin: 0; background: #fff; }'
                        + '@media print { body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }'
                        + '<\/style>'
                        + '<\/head><body>' + html + '<\/body><\/html>');
                    doc.close();

                    printFrame.onload = function() {
                        setTimeout(function() {
                            printFrame.contentWindow.focus();
                            printFrame.contentWindow.print();
                            setTimeout(function() {
                                document.body.removeChild(printFrame);
                            }, 1000);
                        }, 300);
                    };
                }

                function exportWord() {
                    var html = buildEstimationHTML();
                    var fullHtml = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40">'
                        + '<head><meta charset="utf-8"><title>Yoode Price Estimation<\/title><\/head>'
                        + '<body>' + html + '<\/body><\/html>';

                    var blob = new Blob(['\ufeff', fullHtml], { type: 'application/msword' });
                    var url = URL.createObjectURL(blob);
                    var link = document.createElement('a');
                    link.href = url;
                    link.download = 'Yoode_Estimate_' + selectedProduct.value.replace(/\s+/g, '_') + '_' + quantity.value + 'pcs.doc';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                }

                return {
                    isDark, toggleTheme,
                    customerTypes, customerType, setCustomerType,
                    products, selectedProduct, onProductChange,
                    quantity, shippingCharges,
                    step, pricePerItem, mrpPerItem, screenPrintMOQWarning,
                    addonLocations, complexityOptions,
                    isAddonEnabled, toggleAddon, getAddonState,
                    getSetupCharge, getRate, getAddonTotal,
                    addonBreakdown, totalAddonPerItem, totalSetupCharges,
                    grandTotal, finalPricePerItem,
                    fmt, exportPDF, exportWord,
                };
            }
        }).mount('#app');
    </script>
</body>

</html>
